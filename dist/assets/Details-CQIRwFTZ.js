import{r as o,j as e,s as D,u as C,f as k}from"./index-C9w3l_Gn.js";function z({personId:d,onClose:s}){const[m,h]=o.useState(""),[n,x]=o.useState(""),[r,p]=o.useState(""),[i,c]=o.useState(""),[l,g]=o.useState(null),[b,j]=o.useState(!1),[v,f]=o.useState(null),[N,y]=o.useState(!1),S=t=>{const a=t.replace(/\D/g,"").slice(0,11);let u=a;a.length>2&&(u=`(${a.slice(0,2)}) ${a.slice(2)}`),a.length>6&&(u=`(${a.slice(0,2)}) ${a.slice(2,7)}-${a.slice(7)}`),x(u)},w=()=>{if(!navigator.geolocation){f("Geolocalização não suportada");return}navigator.geolocation.getCurrentPosition(t=>{const a=`${t.coords.latitude}, ${t.coords.longitude}`;c(a)},()=>f("Não foi possível obter localização"))},E=async t=>{t.preventDefault(),j(!0),f(null);try{const a=new FormData;a.append("observacao",m),a.append("telefone",n),a.append("dataInformacao",r),a.append("localizacao",i),l&&Array.from(l).forEach(u=>a.append("fotos",u)),await D(d,a),y(!0),setTimeout(()=>{s()},1500)}catch(a){f(a.message||"Erro ao enviar informações")}finally{j(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-lg w-full p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Enviar informação"}),v&&e.jsx("div",{className:"text-red-600 mb-2",children:v}),N&&e.jsx("div",{className:"text-green-600 mb-2",children:"Enviado com sucesso!"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Observação"}),e.jsx("textarea",{value:m,onChange:t=>h(t.target.value),className:"w-full border rounded p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Telefone"}),e.jsx("input",{type:"text",value:n,onChange:t=>S(t.target.value),className:"w-full border rounded p-2",placeholder:"(65) 99999-9999",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Data da informação"}),e.jsx("input",{type:"date",value:r,onChange:t=>p(t.target.value),className:"w-full border rounded p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Localização"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:i,onChange:t=>c(t.target.value),className:"flex-1 border rounded p-2",placeholder:"latitude, longitude"}),e.jsx("button",{type:"button",onClick:w,className:"bg-gray-200 px-3 rounded hover:bg-gray-300",children:"Usar GPS"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Fotos"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:t=>g(t.target.files),className:"w-full"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 rounded border border-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:b,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:b?"Enviando...":"Enviar"})]})]})]})})}function I(){const{id:d}=C(),[s,m]=o.useState(null),[h,n]=o.useState(!0),[x,r]=o.useState(null),[p,i]=o.useState(!1);if(o.useEffect(()=>{if(!d){r("ID da pessoa não informado"),n(!1);return}n(!0),k(d).then(l=>{m(l),r(null)}).catch(l=>{r(l.message||"Erro ao buscar dados")}).finally(()=>n(!1))},[d]),h)return e.jsx("div",{className:"p-4",children:"Carregando..."});if(x)return e.jsx("div",{className:"p-4 text-red-500",children:x});if(!s)return e.jsx("div",{className:"p-4",children:"Nenhuma pessoa encontrada"});const c=l=>l?new Date(l).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"—";return e.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded shadow",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsx("img",{src:s.urlFoto||"/placeholder.png",alt:s.nome,className:"w-40 h-40 object-cover rounded",onError:l=>l.currentTarget.src="/placeholder.png"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s.nome}),e.jsxs("p",{className:"text-gray-600",children:[s.idade?`${s.idade} anos`:""," ",s.sexo||""]}),e.jsx("span",{className:`inline-block mt-2 px-3 py-1 rounded text-sm font-medium ${s.status==="DESAPARECIDO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:s.status})]})]}),e.jsxs("dl",{className:"mt-4 space-y-2",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"font-semibold",children:"Data do desaparecimento:"}),e.jsx("dd",{children:c(s.dataDesaparecimento)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-semibold",children:"Data da localização:"}),e.jsx("dd",{children:c(s.dataLocalizacao)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"font-semibold",children:"Encontrado com vida?"}),e.jsx("dd",{children:s.encontradoVivo?"Sim":"Não"})]})]}),e.jsx("button",{onClick:()=>i(!0),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Enviar informação"}),p&&s.id!==void 0&&e.jsx(z,{personId:s.id.toString(),onClose:()=>i(!1)})]})}export{I as default};
