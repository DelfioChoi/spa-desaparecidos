import{a as Z,r as I,g as G,j as l,u as H}from"./index-r28vV2A_.js";import{s as J,a as K}from"./api-BztLRbaK.js";var X={exports:{}};function Q(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var F=Q(I),ee=Z;function te(t,a){for(var s=Object.getOwnPropertyNames(a),n=0;n<s.length;n++){var e=s[n],r=Object.getOwnPropertyDescriptor(a,e);r&&r.configurable&&t[e]===void 0&&Object.defineProperty(t,e,r)}return t}function B(){return(B=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t}).apply(this,arguments)}function ne(t,a){t.prototype=Object.create(a.prototype),te(t.prototype.constructor=t,a)}function ae(t,a){if(t==null)return{};var s,n,e={},r=Object.keys(t);for(n=0;n<r.length;n++)s=r[n],0<=a.indexOf(s)||(e[s]=t[s]);return e}function E(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var se=function(t,a,s,n,e,r,d,g){if(!t){var i;if(a===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[s,n,e,r,d,g],f=0;(i=new Error(a.replace(/%s/g,function(){return u[f++]}))).name="Invariant Violation"}throw i.framesToPop=1,i}},_=se;function z(t,a,s){if("selectionStart"in t&&"selectionEnd"in t)t.selectionStart=a,t.selectionEnd=s;else{var n=t.createTextRange();n.collapse(!0),n.moveStart("character",a),n.moveEnd("character",s-a),n.select()}}function oe(t){var a=0,s=0;if("selectionStart"in t&&"selectionEnd"in t)a=t.selectionStart,s=t.selectionEnd;else{var n=document.selection.createRange();n.parentElement()===t&&(a=-n.moveStart("character",-t.value.length),s=-n.moveEnd("character",-t.value.length))}return{start:a,end:s,length:s-a}}var re={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},ie="_";function U(t,a,s){var n="",e="",r=null,d=[];if(a===void 0&&(a=ie),s==null&&(s=re),!t||typeof t!="string")return{maskChar:a,formatChars:s,mask:null,prefix:null,lastEditablePosition:null,permanents:[]};var g=!1;return t.split("").forEach(function(i){g=!g&&i==="\\"||(g||!s[i]?(d.push(n.length),n.length===d.length-1&&(e+=i)):r=n.length+1,n+=i,!1)}),{maskChar:a,formatChars:s,prefix:e,mask:n,lastEditablePosition:r,permanents:d}}function M(t,a){return t.permanents.indexOf(a)!==-1}function V(t,a,s){var n=t.mask,e=t.formatChars;if(!s)return!1;if(M(t,a))return n[a]===s;var r=e[n[a]];return new RegExp(r).test(s)}function q(t,a){return a.split("").every(function(s,n){return M(t,n)||!V(t,n,s)})}function P(t,a){var s=t.maskChar,n=t.prefix;if(!s){for(;a.length>n.length&&M(t,a.length-1);)a=a.slice(0,a.length-1);return a.length}for(var e=n.length,r=a.length;r>=n.length;r--){var d=a[r];if(!M(t,r)&&V(t,r,d)){e=r+1;break}}return e}function Y(t,a){return P(t,a)===t.mask.length}function y(t,a){var s=t.maskChar,n=t.mask,e=t.prefix;if(!s){for((a=T(t,"",a,0)).length<e.length&&(a=e);a.length<n.length&&M(t,a.length);)a+=n[a.length];return a}if(a)return T(t,y(t,""),a,0);for(var r=0;r<n.length;r++)M(t,r)?a+=n[r]:a+=s;return a}function le(t,a,s,n){var e=s+n,r=t.maskChar,d=t.mask,g=t.prefix,i=a.split("");if(r)return i.map(function(f,x){return x<s||e<=x?f:M(t,x)?d[x]:r}).join("");for(var u=e;u<i.length;u++)M(t,u)&&(i[u]="");return s=Math.max(g.length,s),i.splice(s,e-s),a=i.join(""),y(t,a)}function T(t,a,s,n){var e=t.mask,r=t.maskChar,d=t.prefix,g=s.split(""),i=Y(t,a);return!r&&n>a.length&&(a+=e.slice(a.length,n)),g.every(function(u){for(;w=u,M(t,m=n)&&w!==e[m];){if(n>=a.length&&(a+=e[n]),f=u,x=n,r&&M(t,x)&&f===r)return!0;if(++n>=e.length)return!1}var f,x,m,w;return!V(t,n,u)&&u!==r||(n<a.length?a=r||i||n<d.length?a.slice(0,n)+u+a.slice(n+1):(a=a.slice(0,n)+u+a.slice(n),y(t,a)):r||(a+=u),++n<e.length)}),a}function ue(t,a,s,n){var e=t.mask,r=t.maskChar,d=s.split(""),g=n;return d.every(function(i){for(;f=i,M(t,u=n)&&f!==e[u];)if(++n>=e.length)return!1;var u,f;return(V(t,n,i)||i===r)&&n++,n<e.length}),n-g}function ce(t,a){for(var s=a;0<=s;--s)if(!M(t,s))return s;return null}function L(t,a){for(var s=t.mask,n=a;n<s.length;++n)if(!M(t,n))return n;return null}function R(t){return t||t===0?t+"":""}function de(t,a,s,n,e){var r=t.mask,d=t.prefix,g=t.lastEditablePosition,i=a,u="",f=0,x=0,m=Math.min(e.start,s.start);return s.end>e.start?x=(f=ue(t,n,u=i.slice(e.start,s.end),m))?e.length:0:i.length<n.length&&(x=n.length-i.length),i=n,x&&(x===1&&!e.length&&(m=e.start===s.start?L(t,s.start):ce(t,s.start)),i=le(t,i,m,x)),i=T(t,i,u,m),(m+=f)>=r.length?m=r.length:m<d.length&&!f?m=d.length:m>=d.length&&m<g&&f&&(m=L(t,m)),u||(u=null),{value:i=y(t,i),enteredString:u,selection:{start:m,end:m}}}function fe(){var t=new RegExp("windows","i"),a=new RegExp("phone","i"),s=navigator.userAgent;return t.test(s)&&a.test(s)}function O(t){return typeof t=="function"}function pe(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame}function $(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame}function W(t){return($()?pe():function(){return setTimeout(t,1e3/60)})(t)}function A(t){($()||clearTimeout)(t)}var he=function(t){function a(n){var e=t.call(this,n)||this;e.focused=!1,e.mounted=!1,e.previousSelection=null,e.selectionDeferId=null,e.saveSelectionLoopDeferId=null,e.saveSelectionLoop=function(){e.previousSelection=e.getSelection(),e.saveSelectionLoopDeferId=W(e.saveSelectionLoop)},e.runSaveSelectionLoop=function(){e.saveSelectionLoopDeferId===null&&e.saveSelectionLoop()},e.stopSaveSelectionLoop=function(){e.saveSelectionLoopDeferId!==null&&(A(e.saveSelectionLoopDeferId),e.saveSelectionLoopDeferId=null,e.previousSelection=null)},e.getInputDOMNode=function(){if(!e.mounted)return null;var o=ee.findDOMNode(E(E(e))),c=typeof window<"u"&&o instanceof window.Element;if(o&&!c)return null;if(o.nodeName!=="INPUT"&&(o=o.querySelector("input")),!o)throw new Error("react-input-mask: inputComponent doesn't contain input node");return o},e.getInputValue=function(){var o=e.getInputDOMNode();return o?o.value:null},e.setInputValue=function(o){var c=e.getInputDOMNode();c&&(e.value=o,c.value=o)},e.setCursorToEnd=function(){var o=P(e.maskOptions,e.value),c=L(e.maskOptions,o);c!==null&&e.setCursorPosition(c)},e.setSelection=function(o,c,v){v===void 0&&(v={});var p=e.getInputDOMNode(),k=e.isFocused();p&&k&&(v.deferred||z(p,o,c),e.selectionDeferId!==null&&A(e.selectionDeferId),e.selectionDeferId=W(function(){e.selectionDeferId=null,z(p,o,c)}),e.previousSelection={start:o,end:c,length:Math.abs(c-o)})},e.getSelection=function(){return oe(e.getInputDOMNode())},e.getCursorPosition=function(){return e.getSelection().start},e.setCursorPosition=function(o){e.setSelection(o,o)},e.isFocused=function(){return e.focused},e.getBeforeMaskedValueChangeConfig=function(){var o=e.maskOptions,c=o.mask,v=o.maskChar,p=o.permanents,k=o.formatChars;return{mask:c,maskChar:v,permanents:p,alwaysShowMask:!!e.props.alwaysShowMask,formatChars:k}},e.isInputAutofilled=function(o,c,v,p){var k=e.getInputDOMNode();try{if(k.matches(":-webkit-autofill"))return!0}catch{}return!e.focused||p.end<v.length&&c.end===o.length},e.onChange=function(o){var c=E(E(e)).beforePasteState,v=E(E(e)).previousSelection,p=e.props.beforeMaskedValueChange,k=e.getInputValue(),b=e.value,C=e.getSelection();e.isInputAutofilled(k,C,b,v)&&(b=y(e.maskOptions,""),v={start:0,end:0,length:0}),c&&(v=c.selection,b=c.value,C={start:v.start+k.length,end:v.start+k.length,length:0},k=b.slice(0,v.start)+k+b.slice(v.end),e.beforePasteState=null);var h=de(e.maskOptions,k,C,b,v),S=h.enteredString,j=h.selection,D=h.value;if(O(p)){var N=p({value:D,selection:j},{value:b,selection:v},S,e.getBeforeMaskedValueChangeConfig());D=N.value,j=N.selection}e.setInputValue(D),O(e.props.onChange)&&e.props.onChange(o),e.isWindowsPhoneBrowser?e.setSelection(j.start,j.end,{deferred:!0}):e.setSelection(j.start,j.end)},e.onFocus=function(o){var c=e.props.beforeMaskedValueChange,v=e.maskOptions,p=v.mask,k=v.prefix;if(e.focused=!0,e.mounted=!0,p){if(e.value)P(e.maskOptions,e.value)<e.maskOptions.mask.length&&e.setCursorToEnd();else{var b=y(e.maskOptions,k),C=y(e.maskOptions,b),h=P(e.maskOptions,C),S=L(e.maskOptions,h),j={start:S,end:S};if(O(c)){var D=c({value:C,selection:j},{value:e.value,selection:null},null,e.getBeforeMaskedValueChangeConfig());C=D.value,j=D.selection}var N=C!==e.getInputValue();N&&e.setInputValue(C),N&&O(e.props.onChange)&&e.props.onChange(o),e.setSelection(j.start,j.end)}e.runSaveSelectionLoop()}O(e.props.onFocus)&&e.props.onFocus(o)},e.onBlur=function(o){var c=e.props.beforeMaskedValueChange,v=e.maskOptions.mask;if(e.stopSaveSelectionLoop(),e.focused=!1,v&&!e.props.alwaysShowMask&&q(e.maskOptions,e.value)){var p="";O(c)&&(p=c({value:p,selection:null},{value:e.value,selection:e.previousSelection},null,e.getBeforeMaskedValueChangeConfig()).value);var k=p!==e.getInputValue();k&&e.setInputValue(p),k&&O(e.props.onChange)&&e.props.onChange(o)}O(e.props.onBlur)&&e.props.onBlur(o)},e.onMouseDown=function(o){if(!e.focused&&document.addEventListener){e.mouseDownX=o.clientX,e.mouseDownY=o.clientY,e.mouseDownTime=new Date().getTime();var c=function v(p){if(document.removeEventListener("mouseup",v),e.focused){var k=Math.abs(p.clientX-e.mouseDownX),b=Math.abs(p.clientY-e.mouseDownY),C=Math.max(k,b),h=new Date().getTime()-e.mouseDownTime;(C<=10&&h<=200||C<=5&&h<=300)&&e.setCursorToEnd()}};document.addEventListener("mouseup",c)}O(e.props.onMouseDown)&&e.props.onMouseDown(o)},e.onPaste=function(o){O(e.props.onPaste)&&e.props.onPaste(o),o.defaultPrevented||(e.beforePasteState={value:e.getInputValue(),selection:e.getSelection()},e.setInputValue(""))},e.handleRef=function(o){e.props.children==null&&O(e.props.inputRef)&&e.props.inputRef(o)};var r=n.mask,d=n.maskChar,g=n.formatChars,i=n.alwaysShowMask,u=n.beforeMaskedValueChange,f=n.defaultValue,x=n.value;e.maskOptions=U(r,d,g),f==null&&(f=""),x==null&&(x=f);var m=R(x);if(e.maskOptions.mask&&(i||m)&&(m=y(e.maskOptions,m),O(u))){var w=n.value;n.value==null&&(w=f),m=u({value:m,selection:null},{value:w=R(w),selection:null},null,e.getBeforeMaskedValueChangeConfig()).value}return e.value=m,e}ne(a,t);var s=a.prototype;return s.componentDidMount=function(){this.mounted=!0,this.getInputDOMNode()&&(this.isWindowsPhoneBrowser=fe(),this.maskOptions.mask&&this.getInputValue()!==this.value&&this.setInputValue(this.value))},s.componentDidUpdate=function(){var n=this.previousSelection,e=this.props,r=e.beforeMaskedValueChange,d=e.alwaysShowMask,g=e.mask,i=e.maskChar,u=e.formatChars,f=this.maskOptions,x=d||this.isFocused(),m=this.props.value!=null,w=m?R(this.props.value):this.value,o=n?n.start:null;if(this.maskOptions=U(g,i,u),this.maskOptions.mask){!f.mask&&this.isFocused()&&this.runSaveSelectionLoop();var c=this.maskOptions.mask&&this.maskOptions.mask!==f.mask;if(f.mask||m||(w=this.getInputValue()),(c||this.maskOptions.mask&&(w||x))&&(w=y(this.maskOptions,w)),c){var v=P(this.maskOptions,w);(o===null||v<o)&&(o=Y(this.maskOptions,w)?v:L(this.maskOptions,v))}!this.maskOptions.mask||!q(this.maskOptions,w)||x||m&&this.props.value||(w="");var p={start:o,end:o};if(O(r)){var k=r({value:w,selection:p},{value:this.value,selection:this.previousSelection},null,this.getBeforeMaskedValueChangeConfig());w=k.value,p=k.selection}this.value=w;var b=this.getInputValue()!==this.value;b?(this.setInputValue(this.value),this.forceUpdate()):c&&this.forceUpdate();var C=!1;p.start!=null&&p.end!=null&&(C=!n||n.start!==p.start||n.end!==p.end),(C||b)&&this.setSelection(p.start,p.end)}else f.mask&&(this.stopSaveSelectionLoop(),this.forceUpdate())},s.componentWillUnmount=function(){this.mounted=!1,this.selectionDeferId!==null&&A(this.selectionDeferId),this.stopSaveSelectionLoop()},s.render=function(){var n,e=this.props,r=(e.mask,e.alwaysShowMask,e.maskChar,e.formatChars,e.inputRef,e.beforeMaskedValueChange,e.children),d=ae(e,["mask","alwaysShowMask","maskChar","formatChars","inputRef","beforeMaskedValueChange","children"]);if(r){O(r)||_(!1);var g=["onChange","onPaste","onMouseDown","onFocus","onBlur","value","disabled","readOnly"],i=B({},d);g.forEach(function(f){return delete i[f]}),n=r(i),g.filter(function(f){return n.props[f]!=null&&n.props[f]!==d[f]}).length&&_(!1)}else n=F.createElement("input",B({ref:this.handleRef},d));var u={onFocus:this.onFocus,onBlur:this.onBlur};return this.maskOptions.mask&&(d.disabled||d.readOnly||(u.onChange=this.onChange,u.onPaste=this.onPaste,u.onMouseDown=this.onMouseDown),d.value!=null&&(u.value=this.value)),n=F.cloneElement(n,u)},a}(F.Component),me=he;X.exports=me;var ve=X.exports;const ge=G(ve);function ke({personId:t,onClose:a,onSent:s}){const[n,e]=I.useState(""),[r,d]=I.useState(""),[g,i]=I.useState(""),[u,f]=I.useState([]),[x,m]=I.useState(""),[w,o]=I.useState(""),[c,v]=I.useState(!1),[p,k]=I.useState(null),b=()=>{if(!navigator.geolocation)return alert("Geolocalização não suportada");navigator.geolocation.getCurrentPosition(h=>{m(String(h.coords.latitude)),o(String(h.coords.longitude))},h=>alert("Não foi possível obter localização: "+h.message))},C=async h=>{h.preventDefault(),v(!0),k(null);try{const S=new FormData;S.append("telefone",n),S.append("observacao",r),g&&S.append("data_avistamento",g),x&&w&&S.append("lat_lng",`${x},${w}`),u.forEach((j,D)=>S.append("fotos",j,j.name)),await J(t,S),s==null||s(),a()}catch(S){k(S.message||"Erro ao enviar informação")}finally{v(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white p-4 rounded w-full max-w-2xl",children:[l.jsx("h3",{className:"font-bold mb-2",children:"Registrar informação"}),l.jsxs("form",{onSubmit:C,className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm",children:"Telefone"}),l.jsx(ge,{mask:"(99) 99999-9999",value:n,onChange:h=>e(h.target.value),children:h=>l.jsx("input",{...h,className:"w-full p-2 border rounded"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm",children:"Data do avistamento"}),l.jsx("input",{type:"date",value:g,onChange:h=>i(h.target.value),className:"w-full p-2 border rounded"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm",children:"Observação"}),l.jsx("textarea",{value:r,onChange:h=>d(h.target.value),className:"w-full p-2 border rounded"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm",children:"Localização (lat / lng)"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{placeholder:"lat",value:x,onChange:h=>m(h.target.value),className:"p-2 border rounded flex-1"}),l.jsx("input",{placeholder:"lng",value:w,onChange:h=>o(h.target.value),className:"p-2 border rounded flex-1"}),l.jsx("button",{type:"button",onClick:b,className:"px-3 py-1 border rounded",children:"Usar minha localização"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm",children:"Fotos (máx. 5)"}),l.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:h=>f(Array.from(h.target.files||[]))}),l.jsx("div",{className:"flex gap-2 mt-2",children:u.slice(0,5).map((h,S)=>l.jsx("img",{src:URL.createObjectURL(h),alt:h.name,className:"w-20 h-20 object-cover rounded"},S))})]}),p&&l.jsx("div",{className:"text-red-600",children:p}),l.jsxs("div",{className:"flex gap-2 justify-end",children:[l.jsx("button",{type:"button",onClick:a,className:"px-3 py-1 border rounded",children:"Cancelar"}),l.jsx("button",{type:"submit",disabled:c,className:"px-3 py-1 bg-blue-600 text-white rounded",children:c?"Enviando...":"Enviar informação"})]})]})]})})}function be(){const{id:t}=H(),[a,s]=I.useState(null),[n,e]=I.useState(!1),[r,d]=I.useState(null),[g,i]=I.useState(!1);return I.useEffect(()=>{t&&(e(!0),K(t).then(u=>s(u)).catch(u=>d(u.message)).finally(()=>e(!1)))},[t]),n?l.jsx("div",{children:"Carregando..."}):r?l.jsx("div",{className:"text-red-600",children:r}):a?l.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[l.jsxs("div",{className:"flex gap-4",children:[l.jsx("img",{src:a.urlFoto||"/placeholder.png",alt:a.nome,className:"w-48 h-48 object-cover rounded"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h2",{className:"text-2xl font-bold",children:a.nome}),l.jsx("p",{className:"mt-2 text-sm",children:a.descricao}),l.jsx("div",{className:"mt-4",children:l.jsx("span",{className:`px-2 py-1 rounded text-sm ${a.status==="DESAPARECIDA"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:a.status})}),l.jsx("div",{className:"mt-4",children:l.jsx("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Registrar Informação"})})]})]}),g&&l.jsx(ke,{personId:a.id,onClose:()=>i(!1),onSent:()=>{}})]}):l.jsx("div",{children:"Registro não encontrado"})}export{be as default};
